# yaml-language-server: $schema=https://linkml.io/linkml-model/linkml_model/jsonschema/meta.schema.json
id: https://github.com/kbase/cdm-schema
name: kbase_cdm
description: Schema for KBase CDM
version: 0.0.1
prefixes:
  kb_cdm: http://kbase.github.io/cdm-schema/
  schema: http://schema.org/
  linkml: https://w3id.org/linkml/
  nmdc: https://w3id.org/nmdc/
  semsql: https://w3id.org/semsql/
  ontoassoc: https://w3id.org/oak/association/
  oa: http://www.w3.org/ns/oa#
  oio: http://www.geneontology.org/formats/oboInOwl#
  biolink: https://w3id.org/biolink/vocab/
  sssom: https://w3id.org/sssom/
  skos: http://www.w3.org/2004/02/skos/core#

default_prefix: kb_cdm
default_range: string

default_curi_maps:
  - semweb_context

imports:
  - linkml:types
  # - nmdc/nmdc
  - rdf
  - owl
  # - obo
  - omo
  - relation_graph
  # - oak_association

slots:
  # id:
  #   identifier: true
  #   range: integer
  #   description: Unique internal identifier for an entity.

  hash:
    range: string
    description: Unique string generated by combining the defining attributes of the class.

  predicate:
    #  range: predicate_enum
     relational_role: PREDICATE

  subject:
    #  range: allele
     relational_role: SUBJECT

  object:
    #  range: gene
     relational_role: OBJECT


classes:
  Name:
    description: The name or label for an entity. This may be a primary name, alternative name, synonym, acronym, or any other label used to refer to an entity.
    attributes:
      name:
        slot_uri: schema:name
        description: The string used as a name.
        required: true

      source:
        description: The source of the name.

      description:
        description: Brief description of the name and/or its relationship to the entity.

  Identifier:
    description: An external identifier for an entity. This should be a URI or CURIE.
    attributes:
      identifier:
        slot_uri: schema:identifier
        description: Fully-qualifier URL or CURIE used as an identifier for an entity.
        range: uriorcurie
        required: true

      source:
        description: The source of the identifier.

      description:
        description: Brief description of the identifier and/or its relationship to the entity.

  NamedThing:
    description: Abstract class to represent things with names.
    abstract: true
    attributes:
      id:
      names:
        description: Names, alternative names, and synonyms for an entity.
        range: Name
        multivalued: true
      description:
        description: Definition or description of the entity.

  NamedThingWithId:
    description: Abstract class to represent things with names and identifiers.
    abstract: true
    is_a: NamedThing
    attributes:
      identifiers:
        description: URIs or CURIEs used to refer to this entity.
        range: Identifier
        multivalued: true

  UniqueNamedThing:
    is_a: NamedThingWithId
    abstract: true
    description: Represents an entity with a hash value generated from combining its unique attributes.
    attributes:
      hash:

  Relationship:
    represents_relationship: true
    slots:
      - subject
      - object
      - predicate

  Protocol:
    is_a: NamedThingWithId
    attributes:
      version:
        description: The version of the protocol that has been used.
      inputs:
        description: The inputs for a protocol; may be software parameters, experimental reagents, etc.
        multivalued: true
      outputs:
        description: The outputs of a protocol; may be physical entities, files, etc.
        multivalued: true

  Contig:
    description: A contig (derived from the word "contiguous") is a set of DNA segments or sequences that overlap in a way that provides a contiguous representation of a genomic region. A contig should not contain any gaps.
    is_a: UniqueNamedThing
    attributes:
      length:
        range: integer
        description: Length of the contig in bp.
      gc_content: #
        range: float
        description: GC content of the contig, expressed as a percentage.
      part_of:
        range: Contigset
        multivalued: true
      features:
        range: Feature
        multivalued: true

  Assembly:
    description: A set of chromosomes, unlocalized and unplaced (random) sequences and alternate loci used to represent an organism's genome or the genomes of a community of organism. Most current assemblies are a haploid representation of an organism's genome, although some loci may be represented more than once. This representation may be obtained from one or more individuals.
    is_a: UniqueNamedThing
    attributes:

      contigs:
        description: The contigs in this contigset.
        range: Contig
        multivalued: true
      n_scaffolds:
        range: integer
        description: Total number of scaffolds
      n_contigs:
        range: integer
        description: Total number of contigs
      scaf_bp:
        range: integer
        description: Total size in bp of all scaffolds
      contig_bp:
        range: integer
        description: Total size in bp of all contigs
      gap_pct:
        range: float
        description: The gap size percentage of all scaffolds
      scaf_N50:
        range: integer
        description: Given a set of scaffolds, each with its own length, the N50 count is defined as the smallest number of scaffolds whose length sum makes up half of contigset size
      scaf_L50:
        range: integer
        description: Given a set of scaffolds, the L50 is defined as the sequence length of the shortest scaffold at 50% of the total contigset length
      ctg_N50:
        range: integer
        description: Given a set of contigs, each with its own length, the N50 count is defined as the smallest number_of_contigs whose length sum makes up half of contigset size
      ctg_L50:
        range: integer
        description: Given a set of contigs, the L50 is defined as the sequence length of the shortest contig at 50% of the total contigset length
      scaf_N90:
        range: integer
        description: Given a set of scaffolds, each with its own length, the N90 count is defined as the smallest number of scaffolds whose length sum makes up 90% of contigset size
      scaf_L90:
        range: integer
        description: The L90 statistic is less than or equal to the L50 statistic; it is the length for which the collection of all scaffolds of that length or longer contains at least 90% of the sum of the lengths of all scaffolds.
      ctg_N90:
        range: integer
        description: Given a set of contigs, each with its own length, the N90 count is defined as the smallest number of contigs whose length sum makes up 90% of contigset size
      ctg_L90:
        range: integer
        description: The L90 statistic is less than or equal to the L50 statistic; it is the length for which the collection of all contigs of that length or longer contains at least 90% of the sum of the lengths of all contigs
      scaf_logsum:
        range: float
        description: The sum of the (length*log(length)) of all scaffolds, times some constant. Increase the contiguity, the score will increase
      scaf_powsum:
        range: float
        description: Powersum of all scaffolds is the same as logsum except that it uses the sum of (length*(length^P)) for some power P (default P=0.25).
      ctg_logsum:
        range: float
        description: The sum of the (length*log(length)) of all contigs, times some constant.
      ctg_powsum:
        range: float
        description: Powersum of all contigs is the same as logsum except that it uses the sum of (length*(length^P)) for some power P (default P=0.25)
      asm_score:
        range: float
        description: A composite score for comparing contigset quality
      scaf_max:
        range: integer
        description: Maximum scaffold length
      ctg_max:
        range: integer
        description: Maximum contig length
      scaf_n_gt50K:
        range: integer
        description: The number of scaffolds longer than 50,000 base pairs.
      scaf_l_gt50k:
        range: integer
        description: The total length of scaffolds longer than 50,000 base pairs
      scaf_pct_gt50K:
        range: float
        description: The percentage of the total assembly length represented by scaffolds longer than 50,000 base pairs
      gc_avg:
        range: float
        description: The average GC content of the contigset, expressed as a percentage
      gc_std:
        range: float
        description: The standard deviation of GC content across the contigset


    # 90+ % complete
    # less than 5% contamination

# e.g. transcripts

  Contigset:
    is_a: UniqueNamedThing
    description: A set of individual, overlapping contigs that represent the complete sequenced genome of an organism.
    aliases:
    - genome
    - biological subject
    attributes:
      # something to do with binning
      # output of maxbin
      checkm2_completeness:
        range: float
        description: Estimate of the completeness of a contigset (MAG or genome), estimated by CheckM2 tool
      checkm2_contamination:
        range: float
        description: Estimate of the contamination of a contigset (MAG or genome), estimated by CheckM2 tool

  EncodedFeature:
    description: An entity generated from a feature.
    is_a: UniqueNamedThing
    attributes:
      type: # varchar [not null]
      encoded_by:
        range: Feature

  Feature:
    is_a: UniqueNamedThing
    description: A feature localized to an interval along a contig.
    comments:
      - corresponds to an entry in GFF3
    see_also:
      - https://github.com/The-Sequence-Ontology/Specifications/blob/master/gff3.md
    attributes:

      encodes:
        description: Known or predicted transcription products from this feature.
        range: EncodedFeature
        multivalued: true

      data_source:
        description: Data source from which this entity came.

      generated_by:
        description: The algorithm or procedure that generated the feature.
        range: Protocol

      type:
        aliases:
          - feature type
        description: The type of the feature; constrained to be either a term from the Sequence Ontology or an SO accession number. Must be sequence_feature (SO:0000110) or an is_a child of it.
        range: uriorcurie
        pattern: ^SO:\d+$

      start: # [not null]
        description: The start and end coordinates of the feature are given in positive 1-based int coordinates, relative to the landmark given in column one. Start is always less than or equal to end. For features that cross the origin of a circular feature (e.g. most bacterial genomes, plasmids, and some viral genomes), the requirement for start to be less than or equal to end is satisfied by making end = the position of the end + the length of the landmark feature. For zero-length features, such as insertion sites, start equals end and the implied site is to the right of the indicated base in the direction of the landmark.
        range: integer

      end: # [not null]
        description: The start and end coordinates of the feature are given in positive 1-based int coordinates, relative to the landmark given in column one. Start is always less than or equal to end. For features that cross the origin of a circular feature (e.g. most bacterial genomes, plasmids, and some viral genomes), the requirement for start to be less than or equal to end is satisfied by making end = the position of the end + the length of the landmark feature. For zero-length features, such as insertion sites, start equals end and the implied site is to the right of the indicated base in the direction of the landmark.
        range: integer

      strand:
        description: The strand of the feature.
        range: StrandType

      cds_phase:
        description: For features of type CDS, the phase indicates where the next codon begins relative to the 5' end (where the 5' end of the CDS is relative to the strand of the CDS feature) of the current CDS feature. cds_phase is required if the feature type is CDS.
        range: CdsPhaseType

      p_value:
        description: The 'score' of the feature. The semantics of this field are ill-defined. P-values should be used for ab initio gene prediction features.
        range: float
      e_value:
        description: The 'score' of the feature. The semantics of this field are ill-defined. E-values should be used for sequence similarity features.
        range: float

  Protein:
    description: Proteins are large, complex molecules made up of one or more long, folded chains of amino acids, whose sequences are determined by the DNA sequence of the protein-encoding gene.
    is_a: UniqueNamedThing
    attributes:
      description:
      length:
        range: integer
      sequence:
      evidence_for_existence:
        range: EvidenceForExistence
      encoded_by:
        description: The feature(s) that encode this protein.
        range: Feature

  Sample:
    is_a: NamedThingWithId

  Project:
    is_a: NamedThingWithId
    description: Administrative unit for collecting data related to a certain topic, location, data type, grant funding, and so on.
    attributes:
      created_at:
        range: datetime

  Experiment:
    is_a: NamedThing
    attributes:
      created_at:
        range: datetime
      part_of:
        range: Project
      has_participant:
        description: Participants in an experiment.
        range: Sample
        multivalued: true

  Event:
    is_a: NamedThing
    attributes:
      location:
      conditions:
        multivalued: true
      created_at:
        range: datetime

  Measurement:
    is_a: NamedThing
    attributes:
      event:
        range: Event
      protocol_used:
        range: Protocol

  ProcessedMeasurement:
    is_a: Measurement
    attributes:
      quality:
        range: integer

enums:
  CdsPhaseType:
    permissible_values:
      0:
      1:
      2:

  StrandType:
    permissible_values:
      positive:
        description: Represented by "+" in a GFF file; the strand is positive with relation to the landmark.
      negative:
        description: Represented by "-" in a GFF file; the strand is negative wrt the landmark.
      unstranded:
        description: Represented by "." in a GFF file; the feature is not stranded.
      unknown:
        description: Represented by "?" in a GFF file. The strandedness is relevant but unknown.

  EvidenceForExistence:
    description: The evidence for the existence of a biological entity. See https://www.uniprot.org/help/protein_existence, https://www.ncbi.nlm.nih.gov/genbank/evidence/,
    permissible_values:

      experimental_evidence_at_protein_level:
        description: Indicates that there is clear experimental evidence for the existence of the protein. The criteria include partial or complete Edman sequencing, clear identification by mass spectrometry, X-ray or NMR structure, good quality protein-protein interaction or detection of the protein by antibodies.

      experimental_evidence_at_transcript_level:
        description: Indicates that the existence of a protein has not been strictly proven but that expression data (such as existence of cDNA(s), RT-PCR or Northern blots) indicate the existence of a transcript.
      protein_inferred_by_homology:
        description: Indicates that the existence of a protein is probable because clear orthologs exist in closely related species.

      protein_predicted:
        description: Used for entries without evidence at protein, transcript, or homology levels.

      protein_uncertain:
        description: Indicates that the existence of the protein is unsure.

  # https://www.ncbi.nlm.nih.gov/genbank/evidence/
  # RefSeq status codes:
  # MODEL	The RefSeq record is provided by the NCBI Genome Annotation pipeline and is not subject to individual review or revision between annotation runs.
  # INFERRED	The RefSeq record has been predicted by genome sequence analysis, but it is not yet supported by experimental evidence. The record may be partially supported by homology data.
  # PREDICTED	The RefSeq record has not yet been subject to individual review, and some aspect of the RefSeq record is predicted.
  # PROVISIONAL	The RefSeq record has not yet been subject to individual review. The initial sequence-to-gene association has been established by outside collaborators or NCBI staff.
  # REVIEWED	The RefSeq record has been reviewed by NCBI staff or by a collaborator. The NCBI review process includes assessing available sequence data and the literature. Some RefSeq records may incorporate expanded sequence and annotation information.
  # VALIDATED	The RefSeq record has undergone an initial review to provide the preferred sequence standard. The record has not yet been subject to final review at which time additional functional information may be provided.
  # WGS	The RefSeq record is provided to represent a collection of whole genome shotgun sequences. These records are not subject to individual review or revisions between genome updates.


  # gene product => go term relationships:
  # https://github.com/geneontology/go-annotation/blob/master/specs/gpad-gpi-2-0.md#allowed-gene-product-to-go-term-relations
  # GO Aspect	Relations Ontology Label	Relations Ontology ID	Usage Guidelines
  # Molecular Function	enables	RO:0002327	Default for MF
  # Molecular Function	contributes to	RO:0002326
  # Biological Process	involved in	RO:0002331
  # Biological Process	acts upstream of	RO:0002263
  # Biological Process	acts upstream of positive effect	RO:0004034
  # Biological Process	acts upstream of negative effect	RO:0004035
  # Biological Process	acts upstream of or within	RO:0002264	Default for BP (GO:0008150) and child terms
  # Biological Process	acts upstream of or within positive effect	RO:0004032
  # Biological Process	acts upstream of or within negative effect	RO:0004033
  # Cellular Component	part of	BFO:0000050	Default for protein-containing complex (GO:0032991) and child terms
  # Cellular Component	located in	RO:0001025	Default for non-protein-containing complex CC terms
  # Cellular Component	is active in	RO:0002432	Used to indicate where a gene product enables its MF
  # Cellular Component  colocalizes with	RO:0002325

  # predicate_enum:
  #   permissible_values:
